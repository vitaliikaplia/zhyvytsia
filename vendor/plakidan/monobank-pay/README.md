# üá∫üá¶üá∫üá¶üá∫üá¶ –ü—Ä–æ—Å—Ç–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è –µ–∫–≤–∞–π—Ä—ñ–Ω–≥—É [MonobankPay](https://api.monobank.ua/) (MonoPay)
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø–æ REST API [—Ç—É—Ç](https://api.monobank.ua/docs/acquiring.html)

–î–ª—è –≤–µ–¥–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –≤–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Ç–æ–∫–µ–Ω –∑ –æ—Å–æ–±–∏—Å—Ç–æ–≥–æ –∫–∞–±—ñ–Ω–µ—Ç—É [https://fop.monobank.ua/](https://fop.monobank.ua/) –∞–±–æ —Ç–µ—Å—Ç–æ–≤–∏–π —Ç–æ–∫–µ–Ω –∑ [https://api.monobank.ua/](https://api.monobank.ua/)

–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É:
```bash
composer require plakidan/monobank-pay
```
–¢–∞–∫–æ–∂ –∑—Ä–æ–±–∏–≤ –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è php5.6:
```bash
composer require plakidan/monobank-pay:dev-php5.6-adaptation
```

### –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –≤–∏–º–æ–≥–∏:
* php >=7.4
* guzzlehttp/guzzle >= 7.0
* starkbank/ecdsa >= 0.0.5

### –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```php

require_once 'vendor/autoload.php';

//—Å—Ç–≤–æ—Ä–∏–ª–∏ –∫–ª—ñ—î–Ω—Ç–∞ - —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç–∏ –±—É–¥—É—Ç—å —Å–ª–∞—Ç–∏—Å—å
$monoClient = new \MonoPay\Client('YOUR_TOKEN_HERE');

//—ñ–∑ –∫–ª—ñ—î–Ω—Ç–∞ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ id —Ç–∞ –Ω–∞–∑–≤—É –º–µ—Ä—á–∞–Ω—Ç–∞
echo $monoClient->getMerchantId();
echo $monoClient->getMerchantName();

//–¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—ñ–≤ —Å—Ç–≤–æ—Ä—é—î–º–æ —Ü–µ–π –æ–±'—î–∫—Ç
$monoPayment = new \MonoPay\Payment($monoClient);

//—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—É
$invoice = $monoPayment->create(
    1000,
    [
        //–¥–µ—Ç–∞–ª—ñ –æ–ø–ª–∞—Ç–∏
        'merchantPaymInfo' => [
            'reference' => 'my_shop_order_28142', //–Ω–æ–º–µ—Ä —á–µ–∫–∞, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, —Ç–æ—â–æ; –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –º–µ—Ä—á–∞–Ω—Ç–æ–º (–≤–∞–º–∏)
            'destination' => '–û–ø–ª–∞—Ç–∞ –∑–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è #28142', //–ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—É
            'basketOrder' => [ //–Ω–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–æ—à–∏–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
                [
                    'name' => '–¢–æ–≤–∞—Ä1', //–Ω–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É
                    'qty' => 2, //–∫—ñ–ª—å–∫—ñ—Å—Ç—å
                    'sum' => 500, //—Å—É–º–∞ —É –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—è—Ö –≤–∞–ª—é—Ç–∏ –∑–∞ –æ–¥–∏–Ω–∏—Ü—é —Ç–æ–≤–∞—Ä—É
                    'icon' => 'https://example.com/images/product1.jpg', //–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É
                    'unit' => '—É–ø.', //–Ω–∞–∑–≤–∞ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–ºi—Ä—É —Ç–æ–≤–∞—Ä—É
                ],
            ],
        ],
        'redirectUrl' => 'https://example.com/order-result', //–∞–¥—Ä–µ—Å–∞ –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è (GET) - –Ω–∞ —Ü—é –∞–¥—Ä–µ—Å—É –±—É–¥–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–æ–≤–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –æ–ø–ª–∞—Ç–∏ (—É —Ä–∞–∑—ñ —É—Å–ø—ñ—Ö—É –∞–±–æ –ø–æ–º–∏–ª–∫–∏)
        'webHookUrl' => 'https://example.com/mono-webhook', //–∞–¥—Ä–µ—Å–∞ –¥–ª—è CallBack (POST) ‚Äì –Ω–∞ —Ü—é –∞–¥—Ä–µ—Å—É –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –¥–∞–Ω—ñ –ø—Ä–æ —Å—Ç–∞–Ω –ø–ª–∞—Ç–µ–∂—É –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ —Å—Ç–∞—Ç—É—Å—É. –ó–º—ñ—Å—Ç —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑–∞–ø–∏—Ç—É ‚Äú–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å—É —Ä–∞—Ö—É–Ω–∫—É‚Äù
        'validity' => 3600 * 24 * 7, //—Å—Ç—Ä–æ–∫ –¥—ñ—ó –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ä–∞—Ö—É–Ω–æ–∫ –ø–µ—Ä–µ—Å—Ç–∞—î –±—É—Ç–∏ –¥—ñ–π—Å–Ω–∏–º —á–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏
        'paymentType' => 'debit', //debit | hold. –¢–∏–ø –æ–ø–µ—Ä–∞—Ü—ñ—ó. –î–ª—è –∑–Ω–∞—á–µ–Ω–Ω—è hold —Ç–µ—Ä–º—ñ–Ω —Å–∫–ª–∞–¥–∞—î 9 –¥–Ω—ñ–≤. –Ø–∫—â–æ —á–µ—Ä–µ–∑ 9 –¥–Ω—ñ–≤ —Ö–æ–ª–¥ –Ω–µ –±—É–¥–µ —Ñ—ñ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ ‚Äî –≤—ñ–Ω —Å–∫–∞—Å–æ–≤—É—î—Ç—å—Å—è
    ]
);
print_r($invoice);

//—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–ª–∞—Ç—ñ–∂
$invoice = $monoPayment->info('2305046jUBEj8WfyaBdB');
print_r($invoice);

//–≤—ñ–¥—à–∫–æ–¥—É–≤–∞–Ω–Ω—è
$result = $monoPayment->refund('2305046jUBEj8WfyaBdB');
print_r($result);

//—Å–∫–∞—Å—É–≤–∞–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –æ–ø–ª–∞—Ç—É
$result = $monoPayment->cancel('2305046jUBEj8WfyaBdB');
print_r($result);

//–¥–µ—Ç–∞–ª—ñ —É—Å–ø—ñ—à–Ω–æ—ó –æ–ø–ª–∞—Ç–∏
$invoiceDetails = $monoPayment->successDetails('2305046jUBEj8WfyaBdB');
print_r($invoiceDetails);

//—Å–ø–∏—Å–∞—Ç–∏ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω—É —Å—É–º–º—É
//–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É: —Å–ø–∏—Å–∞—Ç–∏ –º–æ–∂–Ω–∞ —Ç—ñ–ª—å–∫–∏ —Ç–∞–∫—É —Å–∞–º–º—É –∞–±–æ –º–µ–Ω—à—É —Å—É–º–º—É —è–∫—É –≤–∏ –∑–∞–±–ª–æ–∫—É–≤–∞–ª–∏
$result = $monoPayment->captureHold('2305046jUBEj8WfyaBdB', 500);
print_r($result);

//—Å–ø–∏—Å–æ–∫ —É—Å–ø—ñ—à–Ω–∏—Ö –æ–ø–ª–∞—Ç –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ —Å—É—Ç–∫–∏
$list = $monoPayment->items(time() - 60 * 60 * 24);
print_r($list);
```

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–µ–±—Ö—É–∫—É:
> –ó–ê–°–¢–ï–†–ï–ñ–ï–ù–ù–Ø!!!
> –û–±–æ–≤'—è–∑–∫–æ–≤–æ –æ–±–≥–æ—Ä–Ω—ñ—Ç—å –æ–±—Ä–æ–±–∫—É –≤–µ–±—Ö—É–∫–∞ –≤ try-catch, –±–æ —è–∫—â–æ –≤–∏ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–µ –ù–ï 200 –∫–æ–¥–æ–º, –∞ –≤–µ–±-—Ö—É–∫—ñ–≤ –±—É–¥–µ –±–∞–≥–∞—Ç–æ - –≤–∞—à IP –º–æ–∂–µ –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –≤ —Ç–∏–º—á–∞—Å–æ–≤–∏–π –±–∞–Ω (—Ö–∑ –Ω–∞ —Å–∫—ñ–ª—å–∫–∏, –≤ –º–µ–Ω–µ –±—É–ª–æ –Ω–∞ —Å—É—Ç–∫–∏)
```php
require_once 'vendor/autoload.php';

//—Å—Ç–≤–æ—Ä–∏–ª–∏ –∫–ª—ñ—î–Ω—Ç–∞ - —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç–∏ –±—É–¥—É—Ç—å —Å–ª–∞—Ç–∏—Å—å
$monoClient = new \MonoPay\Client('YOUR_TOKEN_HERE');

//–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞ (–±–∞–∂–∞–Ω–æ –∑–∞–∫–µ—à—É–≤–∞—Ç–∏)
$publicKey = $monoClient->getPublicKey();

//–∫–ª–∞—Å—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –≤–µ–±—Ö—É–∫–æ–º
$monoWebhook = new \MonoPay\Webhook($monoClient, $publicKey, $_SERVER['HTTP_X_SIGN']);
//–æ—Ç—Ä–∏–º—É—î–º–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
$body = file_get_contents('php://input');
//–≤–∞–ª—ñ–¥—É—î–º–æ –¥–∞–Ω—ñ
if ($monoWebhook->verify($body)) {
    echo '–¶—ñ –¥–∞–Ω—ñ –ø—Ä–∏—Å–ª–∞–≤ –º–æ–Ω–æ–±–∞–Ω–∫, –º–æ–∂–Ω–∞ –æ–±—Ä–æ–±–ª—è—Ç–∏';
} else {
    echo '–î–∞–Ω—ñ –ø—Ä–∏—Å–ª–∞–≤ —à–∞—Ö—Ä–∞–π, —ñ–≥–Ω–æ—Ä—É—î–º–æ';
}
```

#### TODO List:
* –î–æ—Ä–æ–±–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ —Å—Ç–æ—Å–æ–≤–Ω–æ —Ç–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—ó –∫–∞—Ä—Ç
* –ü–µ—Ä–µ—Ä–æ–±–∏—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —ñ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–∞ –∫–ª–∞—Å–∏ –∑ –æ–ø–∏—Å–∞–Ω–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
* –ü–æ–ø—Ä–æ—Å–∏—Ç–∏ –≤ –ì–æ—Ä–æ—Ö–æ–≤—Å—å–∫–æ–≥–æ –±–∞–Ω–æ—á–∫—É –ø–∏–≤–∞

### P.S. –ë—É–¥—É —Ä–∞–¥–∏–π –≤–∞—à–∏–º pull-—Ä–µ–∫–≤–µ—Å—Ç–∞–º
